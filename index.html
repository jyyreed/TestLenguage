<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Idioma Speaker</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    input, select, button {
      padding: 10px;
      font-size: 1.2em;
      margin: 10px;
    }
  </style>
</head>
<body>
  <h2>ðŸ”Š PronunciaciÃ³n desde Google Sheets</h2>
  <p><strong>Palabra:</strong> <span id="displayWord">Cargando...</span></p>
  <select id="language">
    <option value="es-ES">EspaÃ±ol</option>
    <option value="zh-CN">Chino</option>
  </select>
  <br>
  <button onclick="speak()">Escuchar</button>

  <script>
    let palabra = "";

    // URL de tu Web App de Google Apps Script (reemplaza con tu URL)
    const API_URL = "https://script.google.com/macros/s/AKfycbyAa_Gu1fm2gpdbFKVJbQObkv3DBUPZBoPGgCa_vA9GWqxzOIPZiMf3noYkpK0A4qbjZA/exec";  // <- cambia esto por tu URL

    // URL del proxy CORS + tu URL de la Web App de Google
const url = "https://cors-anywhere.herokuapp.com/https://script.google.com/macros/s/AKfycbyF7Ou83nCQzKRyXIt2NdOk4x2Ach9LZiOB2wVq14QF/dev";

// Hacemos la solicitud de la palabra desde la celda A2
fetch(url)
  .then(response => response.text())
  .then(data => {
    // AquÃ­ puedes usar la palabra devuelta
    console.log(data);
  })
  .catch(error => console.error("Error al hacer la solicitud:", error));

    function speak() {
      const lang = document.getElementById("language").value;
      const utterance = new SpeechSynthesisUtterance(palabra);
      utterance.lang = lang;
      speechSynthesis.speak(utterance);
    }
  </script>
</body>
</html>
